var e=require("@coral-xyz/anchor"),t=require("@solana/web3.js");function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,t}var n=/*#__PURE__*/r(e);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}const a=new t.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");new t.PublicKey("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb");const c=new t.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");function u(e){var t={exports:{}};return e(t,t.exports),t.exports}new t.PublicKey("So11111111111111111111111111111111111111112"),new t.PublicKey("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP");for(var l=[],f=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0;p<64;++p)l[p]=m[p],f[m.charCodeAt(p)]=p;function d(e,t,r){for(var n,i=[],o=t;o<r;o+=3)i.push(l[(n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+l[n>>12&63]+l[n>>6&63]+l[63&n]);return i.join("")}f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63;var g=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,h=r?-1:1,m=e[t+f];for(f+=h,o=m&(1<<-l)-1,m>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+f],f+=h,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:Infinity*(m?-1:1);s+=Math.pow(2,n),o-=u}return(m?-1:1)*s*Math.pow(2,o-n)},y=function(e,t,r,n,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:o-1,p=n?1:-1,d=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||Infinity===t?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+f>=1?h/c:h*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*c-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[r+m]=255&a,m+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+m]=255&s,m+=p,s/=256,u-=8);e[r+m-p]|=128*d},w=u(function(e,t){const r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50;const n=2147483647;function i(e){if(e>n)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return s(e,t,r)}function s(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|w(e,t);let n=i(r);const s=n.write(e,t);return s!==r&&(n=n.slice(0,s)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return m(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return m(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return o.from(n,t,r);const s=function(e){if(o.isBuffer(e)){const t=0|p(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Z(e.length)?i(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return a(e),i(e<0?0:0|p(e))}function u(e){const t=e.length<0?0:0|p(e.length),r=i(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function m(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,o.prototype),n}function p(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function w(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(i)return n?-1:G(e).length;t=(""+t).toLowerCase(),i=!0}}function b(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,r);case"utf8":case"utf-8":return K(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return M(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function P(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:A(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):A(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function A(e,t,r,n,i){let o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(u(e,o+n)!==u(t,n)){r=!1;break}if(r)return o}return-1}function E(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(Z(n))return s;e[r+s]=n}return s}function S(e,t,r,n){return X(G(t,e.length-r),e,r,n)}function B(e,t,r,n){return X(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function j(e,t,r,n){return X(Q(t),e,r,n)}function U(e,t,r,n){return X(function(e,t){let r,n,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function I(e,t,r){return function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(d(e,s,s+o>a?a:s+o));return 1===n?i.push(l[(t=e[r-1])>>2]+l[t<<4&63]+"=="):2===n&&i.push(l[(t=(e[r-2]<<8)+e[r-1])>>10]+l[t>>4&63]+l[t<<2&63]+"="),i.join("")}(0===t&&r===e.length?e:e.slice(t,r))}function K(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(o=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(e){const t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=x));return r}(n)}t.kMaxLength=n,(o.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return s(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return function(e,t,r){return a(e),e<=0?i(e):void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)}(e,t,r)},o.allocUnsafe=function(e){return c(e)},o.allocUnsafeSlow=function(e){return c(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(J(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=o.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(J(t,Uint8Array))i+t.length>n.length?(o.isBuffer(t)||(t=o.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!o.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},o.byteLength=w,o.prototype._isBuffer=!0,o.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},o.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},o.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},o.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?K(this,0,e):b.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(e,t,r,n,i){if(J(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const c=Math.min(s,a),u=this.slice(n,i),l=e.slice(t,r);for(let e=0;e<c;++e)if(u[e]!==l[e]){s=u[e],a=l[e];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return P(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return P(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":case"latin1":case"binary":return B(this,e,t,r);case"base64":return j(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function T(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function M(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function C(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=ee[e[n]];return i}function k(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function L(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function z(e,t,r,n,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function O(e,t,r,n,i){Y(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function R(e,t,r,n,i){Y(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function W(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(e,t,r,n,i){return t=+t,r>>>=0,i||W(e,0,r,4),y(e,t,r,n,23,4),r+4}function _(e,t,r,n,i){return t=+t,r>>>=0,i||W(e,0,r,8),y(e,t,r,n,52,8),r+8}o.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=te(function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))}),o.prototype.readBigUInt64BE=te(function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||L(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||L(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=te(function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];return void 0!==t&&void 0!==r||q(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),o.prototype.readBigInt64BE=te(function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),o.prototype.readFloatLE=function(e,t){return e>>>=0,t||L(e,4,this.length),g(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||L(e,4,this.length),g(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||L(e,8,this.length),g(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||L(e,8,this.length),g(this,e,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||z(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||z(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigUInt64LE=te(function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=te(function(e,t=0){return R(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);z(this,e,t,r,n-1,-n)}let i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);z(this,e,t,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigInt64LE=te(function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=te(function(e,t=0){return R(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeFloatLE=function(e,t,r){return N(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return N(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return _(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return _(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=o.isBuffer(e)?e:o.from(e,n),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};const F={};function D(e,t,r){F[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function V(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function Y(e,t,r,n,i,o){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){$(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||q(t,e.length-(r+1))}(n,i,o)}function $(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,r){if(Math.floor(e)!==e)throw $(e,r),new F.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}D("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),D("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),D("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=V(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=V(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);const H=/[^+/0-9A-Za-z-_]/g;function G(e,t){let r;t=t||Infinity;const n=e.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Q(e){return function(e){var t,r,n=function(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}(e),i=n[0],o=n[1],s=new h(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),a=0,c=o>0?i-4:i;for(r=0;r<c;r+=4)t=f[e.charCodeAt(r)]<<18|f[e.charCodeAt(r+1)]<<12|f[e.charCodeAt(r+2)]<<6|f[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;return 2===o&&(t=f[e.charCodeAt(r)]<<2|f[e.charCodeAt(r+1)]>>4,s[a++]=255&t),1===o&&(t=f[e.charCodeAt(r)]<<10|f[e.charCodeAt(r+1)]<<4|f[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t),s}(function(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function X(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const ee=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function te(e){return"undefined"==typeof BigInt?re:e}function re(){throw new Error("BigInt not supported")}}),b=u(function(e,t){function r(e){if(!(e instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function n(e){return r(e),w.Buffer.from(e.buffer,e.byteOffset,e.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.s16=t.s8=t.nu64be=t.u48be=t.u40be=t.u32be=t.u24be=t.u16be=t.nu64=t.u48=t.u40=t.u32=t.u24=t.u16=t.u8=t.offset=t.greedy=t.Constant=t.UTF8=t.CString=t.Blob=t.Boolean=t.BitField=t.BitStructure=t.VariantLayout=t.Union=t.UnionLayoutDiscriminator=t.UnionDiscriminator=t.Structure=t.Sequence=t.DoubleBE=t.Double=t.FloatBE=t.Float=t.NearInt64BE=t.NearInt64=t.NearUInt64BE=t.NearUInt64=t.IntBE=t.Int=t.UIntBE=t.UInt=t.OffsetLayout=t.GreedyCount=t.ExternalLayout=t.bindConstructorLayout=t.nameWithProperty=t.Layout=t.uint8ArrayToBuffer=t.checkUint8Array=void 0,t.constant=t.utf8=t.cstr=t.blob=t.unionLayoutDiscriminator=t.union=t.seq=t.bits=t.struct=t.f64be=t.f64=t.f32be=t.f32=t.ns64be=t.s48be=t.s40be=t.s32be=t.s24be=t.s16be=t.ns64=t.s48=t.s40=t.s32=t.s24=void 0,t.checkUint8Array=r,t.uint8ArrayToBuffer=n;class i{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}function o(e,t){return t.property?e+"["+t.property+"]":e}t.Layout=i,t.nameWithProperty=o,t.bindConstructorLayout=function(e,t){if("function"!=typeof e)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(e,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof i))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");e.layout_=t,t.boundConstructor_=e,t.makeDestinationObject=()=>new e,Object.defineProperty(e.prototype,"encode",{value(e,r){return t.encode(this,e,r)},writable:!0}),Object.defineProperty(e,"decode",{value:(e,r)=>t.decode(e,r),writable:!0})};class s extends i{isCount(){throw new Error("ExternalLayout is abstract")}}t.ExternalLayout=s;class a extends s{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){return r(e),Math.floor((e.length-t)/this.elementSpan)}encode(e,t,r){return 0}}t.GreedyCount=a;class c extends s{constructor(e,t=0,r){if(!(e instanceof i))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof u||this.layout instanceof l}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}t.OffsetLayout=c;class u extends i{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return n(e).readUIntLE(t,this.span)}encode(e,t,r=0){return n(t).writeUIntLE(e,r,this.span),this.span}}t.UInt=u;class l extends i{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return n(e).readUIntBE(t,this.span)}encode(e,t,r=0){return n(t).writeUIntBE(e,r,this.span),this.span}}t.UIntBE=l;class f extends i{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return n(e).readIntLE(t,this.span)}encode(e,t,r=0){return n(t).writeIntLE(e,r,this.span),this.span}}t.Int=f;class h extends i{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return n(e).readIntBE(t,this.span)}encode(e,t,r=0){return n(t).writeIntBE(e,r,this.span),this.span}}t.IntBE=h;const m=Math.pow(2,32);function p(e){const t=Math.floor(e/m);return{hi32:t,lo32:e-t*m}}function d(e,t){return e*m+t}class g extends i{constructor(e){super(8,e)}decode(e,t=0){const r=n(e),i=r.readUInt32LE(t);return d(r.readUInt32LE(t+4),i)}encode(e,t,r=0){const i=p(e),o=n(t);return o.writeUInt32LE(i.lo32,r),o.writeUInt32LE(i.hi32,r+4),8}}t.NearUInt64=g;class y extends i{constructor(e){super(8,e)}decode(e,t=0){const r=n(e);return d(r.readUInt32BE(t),r.readUInt32BE(t+4))}encode(e,t,r=0){const i=p(e),o=n(t);return o.writeUInt32BE(i.hi32,r),o.writeUInt32BE(i.lo32,r+4),8}}t.NearUInt64BE=y;class b extends i{constructor(e){super(8,e)}decode(e,t=0){const r=n(e),i=r.readUInt32LE(t);return d(r.readInt32LE(t+4),i)}encode(e,t,r=0){const i=p(e),o=n(t);return o.writeUInt32LE(i.lo32,r),o.writeInt32LE(i.hi32,r+4),8}}t.NearInt64=b;class v extends i{constructor(e){super(8,e)}decode(e,t=0){const r=n(e);return d(r.readInt32BE(t),r.readUInt32BE(t+4))}encode(e,t,r=0){const i=p(e),o=n(t);return o.writeInt32BE(i.hi32,r),o.writeUInt32BE(i.lo32,r+4),8}}t.NearInt64BE=v;class P extends i{constructor(e){super(4,e)}decode(e,t=0){return n(e).readFloatLE(t)}encode(e,t,r=0){return n(t).writeFloatLE(e,r),4}}t.Float=P;class A extends i{constructor(e){super(4,e)}decode(e,t=0){return n(e).readFloatBE(t)}encode(e,t,r=0){return n(t).writeFloatBE(e,r),4}}t.FloatBE=A;class E extends i{constructor(e){super(8,e)}decode(e,t=0){return n(e).readDoubleLE(t)}encode(e,t,r=0){return n(t).writeDoubleLE(e,r),8}}t.Double=E;class S extends i{constructor(e){super(8,e)}decode(e,t=0){return n(e).readDoubleBE(t)}encode(e,t,r=0){return n(t).writeDoubleBE(e,r),8}}t.DoubleBE=S;class B extends i{constructor(e,t,r){if(!(e instanceof i))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof s&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let n=-1;!(t instanceof s)&&0<e.span&&(n=t*e.span),super(n,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,n=this.count;if(n instanceof s&&(n=n.decode(e,t)),0<this.elementLayout.span)r=n*this.elementLayout.span;else{let i=0;for(;i<n;)r+=this.elementLayout.getSpan(e,t+r),++i}return r}decode(e,t=0){const r=[];let n=0,i=this.count;for(i instanceof s&&(i=i.decode(e,t));n<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),n+=1;return r}encode(e,t,r=0){const n=this.elementLayout,i=e.reduce((e,i)=>e+n.encode(i,t,r+e),0);return this.count instanceof s&&this.count.encode(e.length,t,r),i}}t.Sequence=B;class j extends i{constructor(e,t,r){if(!Array.isArray(e)||!e.reduce((e,t)=>e&&t instanceof i,!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===r&&(r=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let n=-1;try{n=e.reduce((e,t)=>e+t.getSpan(),0)}catch(e){}super(n,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((r,n)=>{const i=n.getSpan(e,t);return t+=i,r+i},0)}catch(e){throw new RangeError("indeterminate span")}return r}decode(e,t=0){r(e);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(e,t)),t+=r.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,r=0){const n=r;let i=0,o=0;for(const n of this.fields){let s=n.span;if(o=0<s?s:0,void 0!==n.property){const i=e[n.property];void 0!==i&&(o=n.encode(i,t,r),0>s&&(s=n.getSpan(t,r)))}i=r,r+=s}return i+o-n}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)void 0!==r.property&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}t.Structure=j;class U{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,r){throw new Error("UnionDiscriminator is abstract")}}t.UnionDiscriminator=U;class I extends U{constructor(e,t){if(!(e instanceof s&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}t.UnionLayoutDiscriminator=I;class K extends i{constructor(e,t,r){let n;if(e instanceof u||e instanceof l)n=new I(new c(e));else if(e instanceof s&&e.isCount())n=new I(e);else{if(!(e instanceof U))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");n=e}if(void 0===t&&(t=null),!(null===t||t instanceof i))throw new TypeError("defaultLayout must be null or a Layout");if(null!==t){if(0>t.span)throw new Error("defaultLayout must have constant span");void 0===t.property&&(t=t.replicate("content"))}let o=-1;t&&(o=t.span,0<=o&&(e instanceof u||e instanceof l)&&(o+=n.layout.span)),super(o,r),this.discriminator=n,this.usesPrefixDiscriminator=e instanceof u||e instanceof l,this.defaultLayout=t,this.registry={};let a=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(e){return a(e)},this.configGetSourceVariant=function(e){a=e.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(r.property&&Object.prototype.hasOwnProperty.call(e,r.property))return r}throw new Error("unable to infer src variant")}decode(e,t=0){let r;const n=this.discriminator,i=n.decode(e,t),o=this.registry[i];if(void 0===o){const o=this.defaultLayout;let s=0;this.usesPrefixDiscriminator&&(s=n.layout.span),r=this.makeDestinationObject(),r[n.property]=i,r[o.property]=o.decode(e,t+s)}else r=o.decode(e,t);return r}encode(e,t,r=0){const n=this.getSourceVariant(e);if(void 0===n){const n=this.discriminator,i=this.defaultLayout;let o=0;return this.usesPrefixDiscriminator&&(o=n.layout.span),n.encode(e[n.property],t,r),o+i.encode(e[i.property],t,r+o)}return n.encode(e,t,r)}addVariant(e,t,r){const n=new x(this,e,t,r);return this.registry[e]=n,n}getVariant(e,t=0){let r;return r=e instanceof Uint8Array?this.discriminator.decode(e,t):e,this.registry[r]}}t.Union=K;class x extends i{constructor(e,t,r,n){if(!(e instanceof K))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof r&&void 0===n&&(n=r,r=null),r){if(!(r instanceof i))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof n)throw new TypeError("variant must have a String property")}let o=e.span;0>e.span&&(o=r?r.span:0,0<=o&&e.usesPrefixDiscriminator&&(o+=e.discriminator.layout.span)),super(o,n),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let n=0;return this.layout&&(n=this.layout.getSpan(e,t+r)),r+n}decode(e,t=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+n):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r=0){let n=0;if(this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let i=n;if(this.layout&&(this.layout.encode(e[this.property],t,r+n),i+=this.layout.getSpan(t,r+n),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}function T(e){return 0>e&&(e+=4294967296),e}t.VariantLayout=x;class M extends i{constructor(e,t,r){if(!(e instanceof u||e instanceof l))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof t&&void 0===r&&(r=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let n=0;this._packedSetValue=function(e){return n=T(e),this},this._packedGetValue=function(){return n}}decode(e,t=0){const r=this.makeDestinationObject(),n=this.word.decode(e,t);this._packedSetValue(n);for(const t of this.fields)void 0!==t.property&&(r[t.property]=t.decode(e));return r}encode(e,t,r=0){const n=this.word.decode(t,r);this._packedSetValue(n);for(const t of this.fields)if(void 0!==t.property){const r=e[t.property];void 0!==r&&t.encode(r)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new C(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new k(this,e);return this.fields.push(t),t}fieldFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}t.BitStructure=M;class C{constructor(e,t,r){if(!(e instanceof M))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const n=8*e.span,i=e.fields.reduce((e,t)=>e+t.bits,0);if(t+i>n)throw new Error("bits too long for span remainder ("+(n-i)+" of "+n+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,32===t&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=n-i-t),this.wordMask=T(this.valueMask<<this.start),this.property=r}decode(e,t){return T(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(e){if("number"!=typeof e||!Number.isInteger(e)||e!==T(e&this.valueMask))throw new TypeError(o("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=T(e<<this.start);this.container._packedSetValue(T(t&~this.wordMask)|r)}}t.BitField=C;class k extends C{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){"boolean"==typeof e&&(e=+e),super.encode(e)}}t.Boolean=k;class L extends i{constructor(e,t){if(!(e instanceof s&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof s||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),n(e).slice(t,t+r)}encode(e,t,r){let i=this.length;if(this.length instanceof s&&(i=e.length),!(e instanceof Uint8Array&&i===e.length))throw new TypeError(o("Blob.encode",this)+" requires (length "+i+") Uint8Array as src");if(r+i>t.length)throw new RangeError("encoding overruns Uint8Array");const a=n(e);return n(t).write(a.toString("hex"),r,i,"hex"),this.length instanceof s&&this.length.encode(i,t,r),i}}t.Blob=L;class z extends i{constructor(e){super(-1,e)}getSpan(e,t=0){r(e);let n=t;for(;n<e.length&&0!==e[n];)n+=1;return 1+n-t}decode(e,t=0){const r=this.getSpan(e,t);return n(e).slice(t,t+r-1).toString("utf-8")}encode(e,t,r=0){"string"!=typeof e&&(e=String(e));const i=w.Buffer.from(e,"utf8"),o=i.length;if(r+o>t.length)throw new RangeError("encoding overruns Buffer");const s=n(t);return i.copy(s,r),s[r+o]=0,o+1}}t.CString=z;class O extends i{constructor(e,t){if("string"==typeof e&&void 0===t&&(t=e,e=void 0),void 0===e)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return r(e),e.length-t}decode(e,t=0){const r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return n(e).slice(t,t+r).toString("utf-8")}encode(e,t,r=0){"string"!=typeof e&&(e=String(e));const i=w.Buffer.from(e,"utf8"),o=i.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(r+o>t.length)throw new RangeError("encoding overruns Buffer");return i.copy(n(t),r),o}}t.UTF8=O;class R extends i{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,r){return 0}}t.Constant=R,t.greedy=(e,t)=>new a(e,t),t.offset=(e,t,r)=>new c(e,t,r),t.u8=e=>new u(1,e),t.u16=e=>new u(2,e),t.u24=e=>new u(3,e),t.u32=e=>new u(4,e),t.u40=e=>new u(5,e),t.u48=e=>new u(6,e),t.nu64=e=>new g(e),t.u16be=e=>new l(2,e),t.u24be=e=>new l(3,e),t.u32be=e=>new l(4,e),t.u40be=e=>new l(5,e),t.u48be=e=>new l(6,e),t.nu64be=e=>new y(e),t.s8=e=>new f(1,e),t.s16=e=>new f(2,e),t.s24=e=>new f(3,e),t.s32=e=>new f(4,e),t.s40=e=>new f(5,e),t.s48=e=>new f(6,e),t.ns64=e=>new b(e),t.s16be=e=>new h(2,e),t.s24be=e=>new h(3,e),t.s32be=e=>new h(4,e),t.s40be=e=>new h(5,e),t.s48be=e=>new h(6,e),t.ns64be=e=>new v(e),t.f32=e=>new P(e),t.f32be=e=>new A(e),t.f64=e=>new E(e),t.f64be=e=>new S(e),t.struct=(e,t,r)=>new j(e,t,r),t.bits=(e,t,r)=>new M(e,t,r),t.seq=(e,t,r)=>new B(e,t,r),t.union=(e,t,r)=>new K(e,t,r),t.unionLayoutDiscriminator=(e,t)=>new I(e,t),t.blob=(e,t)=>new L(e,t),t.cstr=e=>new z(e),t.utf8=(e,t)=>new O(e,t),t.constant=(e,t)=>new R(e,t)});const v=e=>({decode:e.decode.bind(e),encode:e.encode.bind(e)}),P=e=>{const r=b.blob(32,e),{encode:n,decode:i}=v(r),o=r;return o.decode=(e,r)=>{const n=i(e,r);return new t.PublicKey(n)},o.encode=(e,t,r)=>{const i=e.toBuffer();return n(i,t,r)},o};class A extends Error{constructor(e){super(e)}}class E extends A{constructor(){super(...arguments),this.name="TokenOwnerOffCurveError"}}function S(e,r,n=!1,i=a,o=c){if(!n&&!t.PublicKey.isOnCurve(r.toBuffer()))throw new E;const[s]=t.PublicKey.findProgramAddressSync([r.toBuffer(),i.toBuffer(),e.toBuffer()],o);return s}function B(e,r,n,i,o=a,s=c){return function(e,r,n,i,o,s=a,u=c){return new t.TransactionInstruction({keys:[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:t.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}],programId:u,data:o})}(e,r,n,i,Buffer.alloc(0),o,s)}b.struct([b.u32("mintAuthorityOption"),P("mintAuthority"),(e=>{const t=b.blob(8,"supply"),{encode:r,decode:n}=v(t),i=t;return i.decode=(e,t)=>{const r=n(e,t);return function(e){{const t=Buffer.from(e);t.reverse();const r=t.toString("hex");return 0===r.length?BigInt(0):BigInt(`0x${r}`)}}(Buffer.from(r))},i.encode=(e,t,n)=>{const i=function(e,t){{const t=e.toString(16),r=Buffer.from(t.padStart(16,"0").slice(0,16),"hex");return r.reverse(),r}}(e);return r(i,t,n)},i})(),b.u8("decimals"),(e=>{const t=b.u8("isInitialized"),{encode:r,decode:n}=v(t),i=t;return i.decode=(e,t)=>!!n(e,t),i.encode=(e,t,n)=>{const i=Number(e);return r(i,t,n)},i})(),b.u32("freezeAuthorityOption"),P("freezeAuthority")]);var j=function(e,t,r){this.rpcUrl=void 0,this.wallet=void 0,this.commitment=void 0,this.wallet=e,this.rpcUrl=t,this.commitment=r},U="BADGEDniMk3LxR5JgHjyFKnSQhNYiXr5etsuzTFCTd1S",I="sapphire_badges",K=new t.PublicKey("87cgLZha919J1D8v1WcoseqXyBHE6jsD9ofvZugByQTp"),x=new t.PublicKey("TLHEWgEvwMs9sHjwSxy78VR7cqZyJkUTECRW2SejnpP"),T={version:"0.1.0",name:"badges",instructions:[{name:"initGlobalState",accounts:[{name:"globalState",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"feeWallet",isMut:!0,isSigner:!1,docs:["CHECK"]},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"projectFee",type:"u64"},{name:"userFee",type:"u64"}]},{name:"changeGlobalFeeWallet",accounts:[{name:"globalState",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"newFeeWallet",isMut:!0,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]}],args:[]},{name:"changeGlobalFee",accounts:[{name:"globalState",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0}],args:[{name:"projectFee",type:{option:"u64"}},{name:"userFee",type:{option:"u64"}}]},{name:"createProject",accounts:[{name:"project",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!0,isSigner:!0},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"feeWallet",isMut:!0,isSigner:!1,docs:["CHECK Will perform our own check"]},{name:"globalState",isMut:!1,isSigner:!1},{name:"globalFeeWallet",isMut:!0,isSigner:!1,docs:["CHECK Will perform our own check"]},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"name",type:"string"},{name:"fee",type:{option:"u64"}}]},{name:"changeProjectFee",accounts:[{name:"project",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!0,isSigner:!0}],args:[{name:"fee",type:"u64"}]},{name:"changeProjectFeeWallet",accounts:[{name:"project",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!1,isSigner:!0},{name:"newFeeWallet",isMut:!0,isSigner:!1,docs:["CHECK will perform our own check"]}],args:[]},{name:"changeProjectName",accounts:[{name:"project",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!1,isSigner:!0}],args:[{name:"name",type:"string"}]},{name:"deleteProject",accounts:[{name:"project",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!1,isSigner:!0},{name:"collectionAddress",isMut:!1,isSigner:!1}],args:[]},{name:"createBadge",accounts:[{name:"badge",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!0,isSigner:!0},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"mint",isMut:!0,isSigner:!0},{name:"project",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"tokenMetadataProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"name",type:"string"},{name:"metadata",type:"string"},{name:"image",type:"string"},{name:"royalty",type:"u16"}]},{name:"deleteBadge",accounts:[{name:"badge",isMut:!0,isSigner:!1},{name:"project",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"projectAuth",isMut:!0,isSigner:!0}],args:[]},{name:"createUserAccount",accounts:[{name:"userAccount",isMut:!0,isSigner:!1},{name:"userAuth",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"initializer",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"project",isMut:!0,isSigner:!1},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"projectAuth",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"dbId",type:{option:"string"}}]},{name:"changeUserAuth",accounts:[{name:"userAccount",isMut:!0,isSigner:!1},{name:"initializer",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"currentUserAuth",isMut:!0,isSigner:!0},{name:"project",isMut:!0,isSigner:!1},{name:"newUserAuth",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"projectAuth",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]}],args:[]},{name:"deleteUserAccount",accounts:[{name:"userAccount",isMut:!0,isSigner:!1},{name:"initializer",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"project",isMut:!0,isSigner:!1},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"projectAuth",isMut:!0,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"userAuth",isMut:!0,isSigner:!0}],args:[]},{name:"addBadgeToUser",accounts:[{name:"userAccount",isMut:!0,isSigner:!1},{name:"initializer",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"userAuth",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"badge",isMut:!1,isSigner:!1},{name:"project",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!0,isSigner:!0},{name:"mint",isMut:!0,isSigner:!1},{name:"escrow",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]},{name:"withdrawBadge",accounts:[{name:"userAccount",isMut:!0,isSigner:!1},{name:"initializer",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"userAuth",isMut:!0,isSigner:!0},{name:"badge",isMut:!1,isSigner:!1},{name:"project",isMut:!0,isSigner:!1},{name:"mint",isMut:!0,isSigner:!1},{name:"escrow",isMut:!0,isSigner:!1},{name:"collectionAddress",isMut:!1,isSigner:!1},{name:"userTokenAccount",isMut:!0,isSigner:!1},{name:"projectAuth",isMut:!1,isSigner:!1,docs:["CHECK this is safe because we are not reading or writing to this account"]},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1}],args:[{name:"badgeIndex",type:"u8"}]}],accounts:[{name:"GlobalState",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"feeWallet",type:"publicKey"},{name:"projectFee",type:"u64"},{name:"userFee",type:"u64"},{name:"bump",type:"u8"}]}},{name:"Badge",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"metadata",type:"string"},{name:"image",type:"string"},{name:"bump",type:"u8"},{name:"project",type:"publicKey"},{name:"mint",type:"publicKey"}]}},{name:"Project",type:{kind:"struct",fields:[{name:"projectAuth",type:"publicKey"},{name:"collectionAddress",type:"publicKey"},{name:"name",type:"string"},{name:"bump",type:"u8"},{name:"feeWallet",type:"publicKey"},{name:"fee",type:"u64"},{name:"badges",type:{vec:"publicKey"}}]}},{name:"UserAccount",type:{kind:"struct",fields:[{name:"userAuth",type:"publicKey"},{name:"badges",type:{vec:"publicKey"}},{name:"bumps",type:"bytes"},{name:"escrows",type:{vec:"publicKey"}},{name:"dbId",type:{option:"string"}},{name:"initializer",type:"publicKey"},{name:"bump",type:"u8"}]}}],errors:[{code:6e3,name:"AuthorityMismatch",msg:"Authority does not match expected authority"},{code:6001,name:"InsufficientFunds",msg:"Insufficient Funds"},{code:6002,name:"InvalidFeeWallet",msg:"Incorrect Fee Wallet"},{code:6003,name:"InvalidMint",msg:"Invalid token mint address"},{code:6004,name:"InvalidOwner",msg:"Invalid account owner, this wallet cannot be used as a fee wallet"},{code:6005,name:"BadgesExist",msg:"All badges must be cleared before deleting a project"},{code:6006,name:"BadgeDoesNotExist",msg:"Badge does not exist"},{code:6007,name:"IncorrectFeeAddress",msg:"Incorrect fee address provided"},{code:6008,name:"CollectionMismatch",msg:"Incorrect collection address provided"},{code:6009,name:"UnexpectedPublicKey",msg:"Incorrect publickey provided"}],metadata:{address:"BADGEDniMk3LxR5JgHjyFKnSQhNYiXr5etsuzTFCTd1S"}};function M(e,r){return t.PublicKey.findProgramAddressSync([Buffer.from("project_state_sapphire_badges","utf-8"),e.toBuffer(),r.toBuffer(),Buffer.from(I,"utf-8")],new t.PublicKey(U))}function C(e,r){return t.PublicKey.findProgramAddressSync([e.toBuffer(),r.toBuffer(),Buffer.from(I,"utf-8")],new t.PublicKey(U))}function k(e){return t.PublicKey.findProgramAddressSync([Buffer.from("metadata"),new t.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s").toBuffer(),e.toBuffer()],new t.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"))}function L(e,r,n){return t.PublicKey.findProgramAddressSync([Buffer.from("user_state_sapphire_badges","utf-8"),e.toBuffer(),r.toBuffer(),n.toBuffer(),Buffer.from(I,"utf-8")],new t.PublicKey(U))}function z(e,r){return t.PublicKey.findProgramAddressSync([e.toBuffer(),r.toBuffer(),Buffer.from(I,"utf-8")],new t.PublicKey(U))}function O(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var R="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function W(e,t,r){if(!e.s){if(r instanceof N){if(!r.s)return void(r.o=W.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(W.bind(null,e,t),W.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var N=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,r){var n=new e,i=this.s;if(i){var o=1&i?t:r;if(o){try{W(n,1,o(this.v))}catch(e){W(n,2,e)}return n}return this}return this.o=function(e){try{var i=e.v;1&e.s?W(n,1,t?t(i):i):r?W(n,1,r(i)):W(n,2,i)}catch(e){W(n,2,e)}},n},e}();function _(e){return e instanceof N&&1&e.s}var F=/*#__PURE__*/function(e){function r(){return e.apply(this,arguments)||this}o(r,e);var i=r.prototype;return i.createBadge=function(e,r,i,o,s){try{var c=this,u=new t.Connection(c.rpcUrl||"https://api.mainnet-beta.solana.com",c.commitment||"finalized"),l=c.wallet instanceof t.Keypair?new n.Wallet(c.wallet):c.wallet,f=new n.AnchorProvider(u,l,{commitment:c.commitment||"finalized"}),h=new n.Program(T,U,f),m=t.Keypair.generate();return Promise.resolve(O(function(){var c=M(l.publicKey,s)[0],f=C(c,m.publicKey)[0],p=k(m.publicKey)[0];return Promise.resolve(h.methods.createBadge(e,r,i,o).accounts({badge:f,projectAuth:l.publicKey,collectionAddress:s,mint:m.publicKey,project:c,systemProgram:n.web3.SystemProgram.programId,tokenProgram:a,tokenMetadataProgram:new t.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),rent:n.web3.SYSVAR_RENT_PUBKEY}).remainingAccounts([{pubkey:t.SYSVAR_INSTRUCTIONS_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!0,isSigner:!1}]).transaction()).then(function(e){return Promise.resolve(u.getLatestBlockhash()).then(function(t){return e.feePayer=l.publicKey,e.recentBlockhash=t.blockhash,e.partialSign(m),Promise.resolve(l.signTransaction(e)).then(function(e){return Promise.resolve(u.sendRawTransaction(e.serialize())).then(function(e){return{transaction:e,mint:m.publicKey}})})})})},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.getCreateBadgeTx=function(e,r,i,o,s){try{var c=this,u=new t.Connection(c.rpcUrl||"https://api.mainnet-beta.solana.com",c.commitment||"finalized"),l=c.wallet instanceof t.Keypair?new n.Wallet(c.wallet):c.wallet,f=new n.AnchorProvider(u,l,{commitment:c.commitment||"finalized"}),h=new n.Program(T,U,f),m=t.Keypair.generate();return Promise.resolve(O(function(){var c=M(l.publicKey,s)[0],f=C(c,m.publicKey)[0],p=k(m.publicKey)[0];return Promise.resolve(h.methods.createBadge(e,r,i,o).accounts({badge:f,projectAuth:l.publicKey,collectionAddress:s,mint:m.publicKey,project:c,systemProgram:n.web3.SystemProgram.programId,tokenProgram:a,tokenMetadataProgram:new t.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),rent:n.web3.SYSVAR_RENT_PUBKEY}).remainingAccounts([{pubkey:t.SYSVAR_INSTRUCTIONS_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!0,isSigner:!1}]).transaction()).then(function(e){return Promise.resolve(u.getLatestBlockhash()).then(function(t){return e.feePayer=l.publicKey,e.recentBlockhash=t.blockhash,e.partialSign(m),{transaction:e,mint:m.publicKey}})})},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.deleteBadge=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(O(function(){var t=M(s.publicKey,r)[0],n=C(t,e)[0];return Promise.resolve(c.methods.deleteBadge().accounts({badge:n,project:t,mint:e,collectionAddress:r,projectAuth:s.publicKey}).rpc())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.getDeleteBadgeTx=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(O(function(){var t=M(s.publicKey,r)[0],n=C(t,e)[0];return Promise.resolve(c.methods.deleteBadge().accounts({badge:n,project:t,mint:e,collectionAddress:r,projectAuth:s.publicKey}).transaction())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.addBadgeToUser=function(e,r,i,o){try{var s=this,u=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),l=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,f=new n.AnchorProvider(u,l,{commitment:s.commitment||"finalized"}),h=new n.Program(T,U,f);return Promise.resolve(O(function(){var s=M(l.publicKey,o)[0],u=C(s,i)[0],f=L(l.publicKey,s,r)[0],m=z(r,i)[0],p=k(i)[0];return Promise.resolve(h.methods.addBadgeToUser().accounts({userAccount:f,initializer:r,userAuth:e,badge:u,project:s,projectAuth:l.publicKey,mint:i,escrow:m,systemProgram:n.web3.SystemProgram.programId,collectionAddress:o,rent:n.web3.SYSVAR_RENT_PUBKEY,tokenProgram:a}).remainingAccounts([{pubkey:t.SYSVAR_INSTRUCTIONS_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:new t.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!0,isSigner:!1}]).rpc())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.getAddBadgeToUserTx=function(e,r,i,o){try{var s=this,u=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),l=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,f=new n.AnchorProvider(u,l,{commitment:s.commitment||"finalized"}),h=new n.Program(T,U,f);return Promise.resolve(O(function(){var s=M(l.publicKey,o)[0],u=C(s,i)[0],f=L(l.publicKey,s,r)[0],m=z(r,i)[0],p=k(i)[0];return Promise.resolve(h.methods.addBadgeToUser().accounts({userAccount:f,initializer:r,userAuth:e,badge:u,project:s,projectAuth:l.publicKey,mint:i,escrow:m,systemProgram:n.web3.SystemProgram.programId,collectionAddress:o,rent:n.web3.SYSVAR_RENT_PUBKEY,tokenProgram:a}).remainingAccounts([{pubkey:t.SYSVAR_INSTRUCTIONS_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:new t.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!0,isSigner:!1}]).transaction())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.withdrawBadge=function(e,r,i,o){try{var s=this,u=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),l=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,f=new n.AnchorProvider(u,l,{commitment:s.commitment||"finalized"}),h=new n.Program(T,U,f);return Promise.resolve(O(function(){var s=M(o,i)[0],f=C(s,r)[0],m=L(o,s,e)[0],p=z(e,r)[0];return Promise.resolve(u.getParsedTokenAccountsByOwner(l.publicKey,{mint:r})).then(function(d){var g=!1,y=d.value.length>0?d.value[0].pubkey:S(r,l.publicKey);return 0===d.value.length&&(g=B(l.publicKey,y,l.publicKey,r,a,c)),Promise.resolve(h.account.userAccount.fetch(m)).then(function(d){var w=d.escrows.findIndex(function(e){return e.toBase58()===p.toBase58()});return Promise.resolve(h.methods.withdrawBadge(w).accounts({userAccount:m,initializer:e,userAuth:l.publicKey,badge:f,project:s,mint:r,escrow:p,collectionAddress:i,userTokenAccount:y,projectAuth:o,systemProgram:n.web3.SystemProgram.programId,tokenProgram:a,associatedTokenProgram:c}).instruction()).then(function(e){var r=g?(new t.Transaction).add(g,e):(new t.Transaction).add(e);return Promise.resolve(u.getLatestBlockhash()).then(function(e){return r.feePayer=l.publicKey,r.recentBlockhash=e.blockhash,Promise.resolve(l.signTransaction(r)).then(function(e){return Promise.resolve(u.sendRawTransaction(e.serialize()))})})})})})},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.getWithdrawBadgeTx=function(e,r,i,o){try{var s=this,u=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),l=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,f=new n.AnchorProvider(u,l,{commitment:s.commitment||"finalized"}),h=new n.Program(T,U,f);return Promise.resolve(O(function(){var s=M(o,i)[0],f=C(s,r)[0],m=L(o,s,e)[0],p=z(e,r)[0];return Promise.resolve(u.getParsedTokenAccountsByOwner(l.publicKey,{mint:r})).then(function(u){var d=!1,g=u.value.length>0?u.value[0].pubkey:S(l.publicKey,r);return 0===u.value.length&&(d=B(l.publicKey,g,l.publicKey,r,a,c)),Promise.resolve(h.account.userAccount.fetch(m)).then(function(u){var y=u.escrow.findIndex(function(e){return e.toBase58()===p.toBase58()});return Promise.resolve(h.methods.withdrawBadge(y).accounts({userAccount:m,initializer:e,userAuth:l.publicKey,badge:f,project:s,mint:r,escrow:p,collectionAddress:i,userTokenAccount:g,projectAuth:o,systemProgram:n.web3.SystemProgram.programId,tokenProgram:a,associatedTokenProgram:c}).instruction()).then(function(e){return d?(new t.Transaction).add(d,e):(new t.Transaction).add(e)})})})},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},i.getBadgeState=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a),u=C(r,e)[0];return Promise.resolve(O(function(){return Promise.resolve(c.account.badgeState.fetch(u)).then(function(e){return{publicKey:u,mint:e.mint,project:e.project,metadata:e.metadata,image:e.image,name:e.name,royalty:e.royalty.toNumber(),bump:e.bump.toNumber()}})},function(e){return new Error(e.message||"An error occurred while fetching the badge state")}))}catch(e){return Promise.reject(e)}},i.getBadgeMetadataUri=function(e){try{var r=this,i=new t.Connection(r.rpcUrl||"https://api.mainnet-beta.solana.com",r.commitment||"finalized"),o=r.wallet instanceof t.Keypair?new n.Wallet(r.wallet):r.wallet,s=new n.AnchorProvider(i,o,{commitment:r.commitment||"finalized"}),a=new n.Program(T,U,s);return Promise.resolve(a.account.badge.all()).then(function(t){var r=t.filter(function(t){return t.account.mint===e});try{return r[0].account.metadata}catch(e){return new Error(e.message||"An error occurred while fetching the badge metadata")}})}catch(e){return Promise.reject(e)}},i.getBadgeImageUri=function(e){try{var r=this,i=new t.Connection(r.rpcUrl||"https://api.mainnet-beta.solana.com",r.commitment||"finalized"),o=r.wallet instanceof t.Keypair?new n.Wallet(r.wallet):r.wallet,s=new n.AnchorProvider(i,o,{commitment:r.commitment||"finalized"}),a=new n.Program(T,U,s);return Promise.resolve(a.account.badge.all()).then(function(t){var r=t.filter(function(t){return t.account.mint===e});try{return r[0].account.image}catch(e){return new Error(e.message||"An error occurred while fetching the badge metadata")}})}catch(e){return Promise.reject(e)}},i.getProjectBadges=function(e){try{var r=this,i=new t.Connection(r.rpcUrl||"https://api.mainnet-beta.solana.com",r.commitment||"finalized"),o=r.wallet instanceof t.Keypair?new n.Wallet(r.wallet):r.wallet,s=new n.AnchorProvider(i,o,{commitment:r.commitment||"finalized"}),a=new n.Program(T,U,s);return Promise.resolve(O(function(){return Promise.resolve(a.account.project.fetch(e)).then(function(e){var t=[],r=function(e,t,r){if("function"==typeof e[R]){var n,i,o,s=e[R]();if(function e(r){try{for(;!(n=s.next()).done;)if((r=t(n.value))&&r.then){if(!_(r))return void r.then(e,o||(o=W.bind(null,i=new N,2)));r=r.v}i?W(i,1,r):i=r}catch(e){W(i||(i=new N),2,e)}}(),s.return){var a=function(e){try{n.done||s.return()}catch(e){}return e};if(i&&i.then)return i.then(a,function(e){throw a(e)});a()}return i}if(!("length"in e))throw new TypeError("Object is not iterable");for(var c=[],u=0;u<e.length;u++)c.push(e[u]);return function(e,t,r){var n,i,o=-1;return function r(s){try{for(;++o<e.length;)if((s=t(o))&&s.then){if(!_(s))return void s.then(r,i||(i=W.bind(null,n=new N,2)));s=s.v}n?W(n,1,s):n=s}catch(e){W(n||(n=new N),2,e)}}(),n}(c,function(e){return t(c[e])})}(e.badges,function(e){return Promise.resolve(a.account.badge.fetch(e)).then(function(r){t.push({publicKey:e,mint:r.mint,project:r.project,metadata:r.metadata,image:r.image,name:r.name,royalty:r.royalty.toNumber(),bump:r.bump.toNumber()})})});return r&&r.then?r.then(function(){return t}):t})},function(e){return new Error(e.message||"An error occurred while fetching the project badges")}))}catch(e){return Promise.reject(e)}},r}(j);function D(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var V=/*#__PURE__*/function(e){function r(){return e.apply(this,arguments)||this}o(r,e);var s=r.prototype;return s.createProject=function(e,r,i,o){try{var s=this,a=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),c=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,u=new n.AnchorProvider(a,c,{commitment:s.commitment||"finalized"}),l=new n.Program(T,U,u);return Promise.resolve(D(function(){var t=M(c.publicKey,r)[0];return Promise.resolve(l.methods.createProject(i,new n.BN(e)).accounts({project:t,projectAuth:c.publicKey,collectionAddress:r,feeWallet:o||c.publicKey,globalState:K,globalFeeWallet:x,systemProgram:n.web3.SystemProgram.programId,rent:n.web3.SYSVAR_RENT_PUBKEY}).rpc())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.getCreateProjectTx=function(e,r,i,o){try{var s=this,a=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),c=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,u=new n.AnchorProvider(a,c,{commitment:s.commitment||"finalized"}),l=new n.Program(T,U,u);return Promise.resolve(D(function(){var t=M(c.publicKey,r)[0];return Promise.resolve(l.methods.createProject(i,new n.BN(e)).accounts({project:t,projectAuth:c.publicKey,collectionAddress:r,feeWallet:o||c.publicKey,globalState:K,globalFeeWallet:x,systemProgram:n.web3.SystemProgram.programId,rent:n.web3.SYSVAR_RENT_PUBKEY}).transaction())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.changeProjectName=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(D(function(){var t=M(s.publicKey,r)[0];return Promise.resolve(c.methods.changeProjectName(e).accounts({project:t,projectAuth:s.publicKey}).rpc())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.getChangeProjectNameTx=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(D(function(){var t=M(s.publicKey,r)[0];return Promise.resolve(c.methods.changeProjectName(e).accounts({project:t,projectAuth:s.publicKey}).transaction())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.changeFeeWallet=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(D(function(){var t=M(s.publicKey,r)[0];return Promise.resolve(c.methods.changeProjectFeeWallet().accounts({project:t,projectAuth:s.publicKey,newFeeWallet:e}).rpc())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.getChangeFeeWalletTx=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(D(function(){var t=M(s.publicKey,r)[0];return Promise.resolve(c.methods.changeProjectFeeWallet().accounts({project:t,projectAuth:s.publicKey,newFeeWallet:e}).transaction())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.changeFee=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(D(function(){var t=M(s.publicKey,r)[0];return Promise.resolve(c.methods.changeProjectFee(new n.BN(e)).accounts({project:t,projectAuth:s.publicKey}).rpc())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.getChangeFeeTx=function(e,r){try{var i=this,o=new t.Connection(i.rpcUrl||"https://api.mainnet-beta.solana.com",i.commitment||"finalized"),s=i.wallet instanceof t.Keypair?new n.Wallet(i.wallet):i.wallet,a=new n.AnchorProvider(o,s,{commitment:i.commitment||"finalized"}),c=new n.Program(T,U,a);return Promise.resolve(D(function(){var t=M(s.publicKey,r)[0];return Promise.resolve(c.methods.changeProjectFee(new n.BN(e)).accounts({project:t,projectAuth:s.publicKey}).transaction())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.deleteProject=function(e){try{var r=this,i=new t.Connection(r.rpcUrl||"https://api.mainnet-beta.solana.com",r.commitment||"finalized"),o=r.wallet instanceof t.Keypair?new n.Wallet(r.wallet):r.wallet,s=new n.AnchorProvider(i,o,{commitment:r.commitment||"finalized"}),a=new n.Program(T,U,s);return Promise.resolve(D(function(){var t=M(o.publicKey,e)[0];return Promise.resolve(a.methods.deleteProject().accounts({project:t,projectAuth:o.publicKey,collectionAddress:e}).rpc())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.getDeleteProjectTx=function(e){try{var r=this,i=new t.Connection(r.rpcUrl||"https://api.mainnet-beta.solana.com",r.commitment||"finalized"),o=r.wallet instanceof t.Keypair?new n.Wallet(r.wallet):r.wallet,s=new n.AnchorProvider(i,o,{commitment:r.commitment||"finalized"}),a=new n.Program(T,U,s);return Promise.resolve(D(function(){var t=M(o.publicKey,e)[0];return Promise.resolve(a.methods.deleteProject().accounts({project:t,projectAuth:o.publicKey,collectionAddress:e}).transaction())},function(e){return new Error(e.message||"An error occurred while building the transaction")}))}catch(e){return Promise.reject(e)}},s.getProjectState=function(e){try{var r=this,i=new t.Connection(r.rpcUrl||"https://api.mainnet-beta.solana.com",r.commitment||"finalized"),o=r.wallet instanceof t.Keypair?new n.Wallet(r.wallet):r.wallet,s=new n.AnchorProvider(i,o,{commitment:r.commitment||"finalized"}),a=new n.Program(T,U,s);return Promise.resolve(D(function(){var t=M(o.publicKey,e)[0];return Promise.resolve(a.account.projectState.fetch(t)).then(function(e){return{publicKey:t,badges:e.badges,fee:e.fee.toNumber(),feeWallet:e.feeWallet,name:e.name,bump:e.bump.toNumber(),collectionAddress:e.collectionAddress}})},function(e){return new Error(e.message||"An error occurred while fetching the project state")}))}catch(e){return Promise.reject(e)}},s.getAllProjects=function(){try{var e=this,r=new t.Connection(e.rpcUrl||"https://api.mainnet-beta.solana.com",e.commitment||"finalized"),o=e.wallet instanceof t.Keypair?new n.Wallet(e.wallet):e.wallet,s=new n.AnchorProvider(r,o,{commitment:e.commitment||"finalized"}),a=new n.Program(T,U,s);return Promise.resolve(D(function(){return Promise.resolve(a.account.projectState.all()).then(function(e){return e.map(function(e){return i({publicKey:e.publicKey},e.account)})})},function(e){return new Error(e.message||"An error occurred while fetching the project state")}))}catch(e){return Promise.reject(e)}},r}(j);function Y(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var $,q=/*#__PURE__*/function(e){function r(){return e.apply(this,arguments)||this}o(r,e);var i=r.prototype;return i.createUser=function(e,r,i){try{var o=this,s=new t.Connection(o.rpcUrl||"https://api.mainnet-beta.solana.com",o.commitment||"finalized"),a=o.wallet instanceof t.Keypair?new n.Wallet(o.wallet):o.wallet,c=new n.AnchorProvider(s,a,{commitment:o.commitment||"finalized"}),u=new n.Program(T,U,c);return Promise.resolve(Y(function(){var t=M(a.publicKey,r)[0],o=L(a.publicKey,t,i)[0];return Promise.resolve(u.methods.createUserAccount(e).accounts({userAccount:o,userAuth:i,initializer:i,project:t,collectionAddress:r,projectAuth:a.publicKey,systemProgram:n.web3.SystemProgram.programId,rent:n.web3.SYSVAR_RENT_PUBKEY}).rpc())},function(e){return new Error(e.message||"Error creating user account transaction")}))}catch(e){return Promise.reject(e)}},i.getCreateUserTx=function(e,r,i){try{var o=this,s=new t.Connection(o.rpcUrl||"https://api.mainnet-beta.solana.com",o.commitment||"finalized"),a=o.wallet instanceof t.Keypair?new n.Wallet(o.wallet):o.wallet,c=new n.AnchorProvider(s,a,{commitment:o.commitment||"finalized"}),u=new n.Program(T,U,c);return Promise.resolve(Y(function(){var t=M(a.publicKey,r)[0],o=L(a.publicKey,t,i)[0];return Promise.resolve(u.methods.createUserAccount(e).accounts({userAccount:o,userAuth:i,initializer:i,project:t,collectionAddress:r,projectAuth:a.publicKey,systemProgram:n.web3.SystemProgram.programId,rent:n.web3.SYSVAR_RENT_PUBKEY}).transaction())},function(e){return new Error(e.message||"Error creating user account transaction")}))}catch(e){return Promise.reject(e)}},i.deleteUser=function(e,r,i){try{var o=this,s=new t.Connection(o.rpcUrl||"https://api.mainnet-beta.solana.com",o.commitment||"finalized"),a=o.wallet instanceof t.Keypair?new n.Wallet(o.wallet):o.wallet,c=new n.AnchorProvider(s,a,{commitment:o.commitment||"finalized"}),u=new n.Program(T,U,c);return Promise.resolve(Y(function(){var t=M(i,r)[0],n=L(i,t,e)[0];return Promise.resolve(u.methods.deleteUserAccount().accounts({userAccount:n,initializer:e,project:t,collectionAddress:r,projectAuth:i,userAuth:a.publicKey}).rpc())},function(e){return new Error(e.message||"Error deleting user account transaction")}))}catch(e){return Promise.reject(e)}},i.getDeleteUserTx=function(e,r,i){try{var o=this,s=new t.Connection(o.rpcUrl||"https://api.mainnet-beta.solana.com",o.commitment||"finalized"),a=o.wallet instanceof t.Keypair?new n.Wallet(o.wallet):o.wallet,c=new n.AnchorProvider(s,a,{commitment:o.commitment||"finalized"}),u=new n.Program(T,U,c);return Promise.resolve(Y(function(){var t=M(i,r)[0],n=L(i,t,e)[0];return Promise.resolve(u.methods.deleteUserAccount().accounts({userAccount:n,initializer:e,project:t,collectionAddress:r,projectAuth:i,userAuth:a.publicKey}).transaction())},function(e){return new Error(e.message||"Error deleting user account transaction")}))}catch(e){return Promise.reject(e)}},i.getChangeUserAuthTx=function(e,r,i,o){try{var s=this,a=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),c=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,u=new n.AnchorProvider(a,c,{commitment:s.commitment||"finalized"}),l=new n.Program(T,U,u);return Promise.resolve(Y(function(){var t=M(o,i)[0],n=L(o,t,e)[0];return Promise.resolve(l.methods.changeUserAuth().accounts({userAccount:n,initializer:e,currentUserAuth:c.publicKey,project:t,newUserAuth:r,collectionAddress:i,projectAuth:o}).transaction())},function(e){return new Error(e.message||"Error changing user authority transaction")}))}catch(e){return Promise.reject(e)}},i.changeUserAuth=function(e,r,i,o){try{var s=this,a=new t.Connection(s.rpcUrl||"https://api.mainnet-beta.solana.com",s.commitment||"finalized"),c=s.wallet instanceof t.Keypair?new n.Wallet(s.wallet):s.wallet,u=new n.AnchorProvider(a,c,{commitment:s.commitment||"finalized"}),l=new n.Program(T,U,u);return Promise.resolve(Y(function(){var t=M(o,i)[0],n=L(o,t,e)[0];return Promise.resolve(l.methods.changeUserAuth().accounts({userAccount:n,initializer:e,currentUserAuth:c.publicKey,project:t,newUserAuth:r,collectionAddress:i,projectAuth:o}).rpc())},function(e){return new Error(e.message||"Error changing user authority transaction")}))}catch(e){return Promise.reject(e)}},i.getUserAccount=function(e,r,i){try{var o=this,s=new t.Connection(o.rpcUrl||"https://api.mainnet-beta.solana.com",o.commitment||"finalized"),a=o.wallet instanceof t.Keypair?new n.Wallet(o.wallet):o.wallet,c=new n.AnchorProvider(s,a,{commitment:o.commitment||"finalized"}),u=new n.Program(T,U,c);return Promise.resolve(Y(function(){var t=M(i,r),n=L(i,t[0],e)[0];return Promise.resolve(u.account.userAccount.fetch(n)).then(function(e){return{pubkey:n,badges:e.badges,userAuth:e.userAuth,bumps:e.bumps.map(function(e){return e.toNumber()}),escrows:e.escrows,dbId:e.dbId,initializer:e.initializer,bump:e.bump.toNumber()}})},function(e){return new Error(e.message||"Error fetching user account")}))}catch(e){return Promise.reject(e)}},i.getAllUserAccounts=function(){try{var e=this,r=new t.Connection(e.rpcUrl||"https://api.mainnet-beta.solana.com",e.commitment||"finalized"),i=e.wallet instanceof t.Keypair?new n.Wallet(e.wallet):e.wallet,o=new n.AnchorProvider(r,i,{commitment:e.commitment||"finalized"}),s=new n.Program(T,U,o);return Promise.resolve(Y(function(){return Promise.resolve(s.account.userAccount.all()).then(function(e){return e.map(function(e){return{pubkey:e.publicKey,badges:e.account.badges,userAuth:e.account.userAuth,bumps:e.account.bumps.map(function(e){return e.toNumber()}),escrows:e.account.escrows,dbId:e.account.dbId,initializer:e.account.initializer,bump:e.bump.toNumber()}})})},function(e){return new Error(e.message||"Error fetching user accounts")}))}catch(e){return Promise.reject(e)}},i.getAllBadgesForUser=function(){try{var e=this,r=new t.Connection(e.rpcUrl||"https://api.mainnet-beta.solana.com",e.commitment||"finalized"),i=e.wallet instanceof t.Keypair?new n.Wallet(e.wallet):e.wallet,o=new n.AnchorProvider(r,i,{commitment:e.commitment||"finalized"}),s=new n.Program(T,U,o);return Promise.resolve(s.account.userAccount.all()).then(function(e){var t=e.find(function(e){return e.account.userAuth===i.publicKey});if(!t)return new Error("User account not found");var r=null==t?void 0:t.account.badges;return r&&r.length?Y(function(){return Promise.resolve(Promise.all(r.map(function(e){try{return Promise.resolve(s.account.badge.fetch(e)).then(function(t){return{publicKey:e,name:t.name,metadata:t.metadata,image:t.image,bump:t.bump.toNumber(),project:t.project,royalty:t.royalty.toNumber(),mint:t.mint}})}catch(e){return Promise.reject(e)}})))},function(e){return new Error(e.message||"Error fetching badges for user")}):new Error("No badges found for user")})}catch(e){return Promise.reject(e)}},r}(j),H=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(j);$=H,[V,q,F].forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(t){Object.defineProperty($.prototype,t,Object.getOwnPropertyDescriptor(e.prototype,t))})}),module.exports=H;
